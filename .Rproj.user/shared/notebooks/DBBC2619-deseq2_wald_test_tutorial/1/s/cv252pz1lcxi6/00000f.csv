"0","# Extract sample columns (everything except EnsemblID and GeneSymbol)"
"0","sample_cols <- setdiff(colnames(counts), c(""EnsemblID"", ""GeneSymbol""))"
"0","count_matrix <- as.matrix(counts[, sample_cols])"
"0",""
"0","# Set row names to EnsemblID"
"0","rownames(count_matrix) <- counts$EnsemblID"
"0",""
"0","# Ensure sample names match between counts and metadata"
"0","# Remove any file extensions or prefixes if needed"
"0","colnames(count_matrix) <- gsub(""\\.(bam|sam)$"", """", colnames(count_matrix))"
"0",""
"0","# Verify sample names match"
"0","cat(""Sample names in counts:"", paste(colnames(count_matrix), collapse = "", ""), ""\n"")"
"1","Sample names in counts:"
"1"," "
"1","SRR1039508, SRR1039509, SRR1039512, SRR1039513, SRR1039516, SRR1039517, SRR1039520, SRR1039521"
"1"," "
"1","
"
"0","cat(""Sample names in metadata:"", paste(metadata$Sample, collapse = "", ""), ""\n"")"
"1","Sample names in metadata:"
"1"," "
"1","SRR1039508, SRR1039509, SRR1039512, SRR1039513, SRR1039516, SRR1039517, SRR1039520, SRR1039521"
"1"," "
"1","
"
"0","# Check if all samples are present"
"0","all(metadata$Sample %in% colnames(count_matrix))"
"1","[1]"
"1"," TRUE"
"1","
"
