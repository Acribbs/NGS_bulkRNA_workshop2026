"0","# Apply LFC shrinkage"
"0","res_shrink <- lfcShrink(dds, "
"0","                        coef = ""Treatment_trt_vs_untrt"","
"0","                        type = ""apeglm"")"
"0",""
"0","# Convert to data frame"
"0","res_shrink_df <- as.data.frame(res_shrink)"
"0","res_shrink_df$EnsemblID <- rownames(res_shrink_df)"
"0",""
"0","# Merge with original results"
"0","comparison_df <- res_df %>%"
"0","  select(EnsemblID, log2FoldChange) %>%"
"0","  rename(log2FoldChange_unshrunken = log2FoldChange) %>%"
"0","  left_join(res_shrink_df[, c(""EnsemblID"", ""log2FoldChange"")], "
"0","            by = ""EnsemblID"") %>%"
"0","  rename(log2FoldChange_shrunken = log2FoldChange)"
