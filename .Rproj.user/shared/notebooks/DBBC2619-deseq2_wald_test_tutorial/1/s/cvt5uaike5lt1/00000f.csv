"0","# Transform counts using variance stabilizing transformation"
"0","vsd <- vst(dds, blind = FALSE)"
"0",""
"0","# Calculate PCA"
"0","pca_data <- plotPCA(vsd, "
"0","                    intgroup = c(""Treatment"", ""CellLine""),"
"0","                    returnData = TRUE)"
"0",""
"0","# Calculate percent variance"
"0","percentVar <- round(100 * attr(pca_data, ""percentVar""))"
"0",""
"0","# Plot PCA"
"0","ggplot(pca_data, aes(x = PC1, y = PC2, "
"0","                     color = Treatment, "
"0","                     shape = CellLine)) +"
"0","  geom_point(size = 4) +"
"0","  theme_bw() +"
"0","  labs(title = ""PCA Plot: Treatment and Cell Line Effects"","
"0","       x = paste0(""PC1: "", percentVar[1], ""% variance""),"
"0","       y = paste0(""PC2: "", percentVar[2], ""% variance"")) +"
"0","  scale_color_manual(values = c(""untrt"" = ""steelblue"", ""trt"" = ""coral"")) +"
"0","  coord_fixed()"
