"0","# Transform counts"
"0","vsd <- vst(dds_status, blind = FALSE)"
"0",""
"0","# Calculate PCA"
"0","pca_data <- plotPCA(vsd, "
"0","                    intgroup = c(""Status"", ""CellType""),"
"0","                    returnData = TRUE)"
"0",""
"0","percentVar <- round(100 * attr(pca_data, ""percentVar""))"
"0",""
"0","# Plot PCA"
"0","ggplot(pca_data, aes(x = PC1, y = PC2, "
"0","                     color = Status, "
"0","                     shape = CellType)) +"
"0","  geom_point(size = 4) +"
"0","  theme_bw() +"
"0","  labs(title = ""PCA Plot: Developmental Stage and Cell Type"","
"0","       x = paste0(""PC1: "", percentVar[1], ""% variance""),"
"0","       y = paste0(""PC2: "", percentVar[2], ""% variance"")) +"
"0","  scale_color_manual(values = c(""virgin"" = ""steelblue"", "
"0","                                ""pregnant"" = ""orange"", "
"0","                                ""lactate"" = ""firebrick"")) +"
"0","  coord_fixed()"
