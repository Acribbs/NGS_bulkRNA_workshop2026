"0","# Check input data"
"0","cat(""Counts file columns:"", paste(colnames(counts), collapse = "", ""), ""\n"")"
"1","Counts file columns:"
"1"," "
"1","EnsemblID, GeneSymbol, MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
"0","cat(""Number of columns in counts:"", ncol(counts), ""\n"")"
"1","Number of columns in counts:"
"1"," "
"1","14"
"1"," "
"1","
"
"0","# Extract sample columns (everything except EnsemblID and GeneSymbol)"
"0","sample_cols <- setdiff(colnames(counts), c(""EnsemblID"", ""GeneSymbol""))"
"0","cat(""Sample columns found:"", length(sample_cols), ""\n"")"
"1","Sample columns found:"
"1"," "
"1","12"
"1"," "
"1","
"
"0","cat(""Sample column names:"", paste(sample_cols, collapse = "", ""), ""\n"")"
"1","Sample column names:"
"1"," "
"1","MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
"0","if (length(sample_cols) == 0) {"
"0","  stop(""No sample columns found in counts file. Please check the file format."")"
"0","}"
"0",""
"0","# Create count matrix and preserve column names"
"0","count_matrix <- as.matrix(counts[, sample_cols, drop = FALSE])"
"0",""
"0","# Ensure column names are preserved"
"0","if (is.null(colnames(count_matrix))) {"
"0","  cat(""Warning: Column names were lost. Restoring from sample_cols.\n"")"
"0","  colnames(count_matrix) <- sample_cols"
"0","}"
"0",""
"0","# Set row names to EnsemblID"
"0","if (!is.null(counts$EnsemblID)) {"
"0","  rownames(count_matrix) <- counts$EnsemblID"
"0","} else {"
"0","  stop(""EnsemblID column not found in counts file."")"
"0","}"
"0",""
"0","# Clean sample names if needed (remove .bam or .sam extensions)"
"0","colnames(count_matrix) <- gsub(""\\.(bam|sam)$"", """", colnames(count_matrix))"
"0",""
"0","# Verify count matrix"
"0","cat(""Count matrix dimensions:"", dim(count_matrix), ""\n"")"
"1","Count matrix dimensions:"
"1"," "
"1","24094"
"1"," "
"1","12"
"1"," "
"1","
"
"0","cat(""Count matrix has column names:"", !is.null(colnames(count_matrix)), ""\n"")"
"1","Count matrix has column names:"
"1"," "
"1","TRUE"
"1"," "
"1","
"
"0","cat(""Sample names in counts:"", paste(colnames(count_matrix), collapse = "", ""), ""\n"")"
"1","Sample names in counts:"
"1"," "
"1","MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
"0","cat(""Sample names in metadata:"", paste(metadata$Sample, collapse = "", ""), ""\n"")"
"1","Sample names in metadata:"
"1"," "
"1","GSM1480291, GSM1480292, GSM1480293, GSM1480294, GSM1480295, GSM1480296, GSM1480297, GSM1480298, GSM1480299, GSM1480300, GSM1480301, GSM1480302"
"1"," "
"1","
"
"0","# Check for matching samples"
"0","samples_in_both <- intersect(colnames(count_matrix), metadata$Sample)"
"0","cat(""Samples in both counts and metadata:"", length(samples_in_both), ""\n"")"
"1","Samples in both counts and metadata:"
"1"," "
"1","0"
"1"," "
"1","
"
"0","if (length(samples_in_both) < length(metadata$Sample)) {"
"0","  cat(""Warning: Some metadata samples not found in counts\n"")"
"0","  cat(""Missing from counts:"", paste(setdiff(metadata$Sample, colnames(count_matrix)), collapse = "", ""), ""\n"")"
"0","}"
"1","Warning: Some metadata samples not found in counts
"
"1","Missing from counts:"
"1"," "
"1","GSM1480291, GSM1480292, GSM1480293, GSM1480294, GSM1480295, GSM1480296, GSM1480297, GSM1480298, GSM1480299, GSM1480300, GSM1480301, GSM1480302"
"1"," "
"1","
"
"0","if (length(samples_in_both) < length(colnames(count_matrix))) {"
"0","  cat(""Warning: Some count samples not found in metadata\n"")"
"0","  cat(""Missing from metadata:"", paste(setdiff(colnames(count_matrix), metadata$Sample), collapse = "", ""), ""\n"")"
"0","}"
"1","Warning: Some count samples not found in metadata
"
"1","Missing from metadata:"
"1"," "
"1","MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
