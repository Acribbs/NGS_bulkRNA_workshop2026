"0","# Set factors with appropriate reference levels"
"0","metadata$Status <- factor(metadata$Status, levels = c(""virgin"", ""pregnant"", ""lactate""))"
"0","metadata$CellType <- factor(metadata$CellType, levels = c(""basal"", ""luminal""))"
"0","metadata$Group <- factor(metadata$Group)"
"0",""
"0","# Ensure sample order matches count matrix"
"0","metadata <- metadata[match(colnames(count_matrix), metadata$Sample), ]"
"0",""
"0","# Verify"
"0","head(metadata)"
