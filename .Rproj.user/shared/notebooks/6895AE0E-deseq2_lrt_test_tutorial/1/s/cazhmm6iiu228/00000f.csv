"0","# Diagnostic checks"
"0","cat(""Count matrix dimensions:"", dim(count_matrix), ""\n"")"
"1","Count matrix dimensions:"
"1"," "
"1","24094"
"1"," "
"1","12"
"1"," "
"1","
"
"0","cat(""Count matrix column names:"", paste(colnames(count_matrix), collapse = "", ""), ""\n"")"
"1","Count matrix column names:"
"1"," "
"1","MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
"0","cat(""Metadata dimensions:"", dim(metadata), ""\n"")"
"1","Metadata dimensions:"
"1"," "
"1","12"
"1"," "
"1","5"
"1"," "
"1","
"
"0","cat(""Metadata row names:"", paste(rownames(metadata), collapse = "", ""), ""\n"")"
"1","Metadata row names:"
"1"," "
"1","MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
"0","# Check if data is available"
"0","if (ncol(count_matrix) == 0) {"
"0","  stop(""Count matrix has no columns. Please check data loading."")"
"0","}"
"0",""
"0","if (nrow(metadata) == 0) {"
"0","  stop(""Metadata is empty. Please check data loading."")"
"0","}"
"0",""
"0","# Calculate total counts"
"0","total_counts <- colSums(count_matrix)"
"0","cat(""Total counts calculated for"", length(total_counts), ""samples\n"")"
"1","Total counts calculated for"
"1"," "
"1","12"
"1"," "
"1","samples
"
"0","# Ensure metadata is aligned with count matrix"
"0","if (!identical(colnames(count_matrix), rownames(metadata))) {"
"0","  cat(""Warning: Aligning metadata with count matrix\n"")"
"0","  metadata <- metadata[match(colnames(count_matrix), rownames(metadata)), ]"
"0","}"
"0",""
"0","# Create QC data frame"
"0","qc_df <- data.frame("
"0","  Sample = colnames(count_matrix),"
"0","  TotalCounts = as.numeric(total_counts),"
"0","  Group = as.character(metadata$Group),"
"0","  CellType = as.character(metadata$CellType),"
"0","  Status = as.character(metadata$Status),"
"0","  stringsAsFactors = FALSE"
"0",")"
"0",""
"0","# Verify the data frame"
"0","cat(""QC data frame dimensions:"", dim(qc_df), ""\n"")"
"1","QC data frame dimensions:"
"1"," "
"1","12"
"1"," "
"1","5"
"1"," "
"1","
"
"0","cat(""QC data frame columns:"", paste(colnames(qc_df), collapse = "", ""), ""\n"")"
"1","QC data frame columns:"
"1"," "
"1","Sample, TotalCounts, Group, CellType, Status"
"1"," "
"1","
"
"0","head(qc_df)"
