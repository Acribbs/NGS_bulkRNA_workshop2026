"0","# Final verification before creating DESeqDataSet"
"0","# Ensure metadata is a data.frame with rownames matching count matrix columns"
"0","metadata_df <- as.data.frame(metadata)"
"0","rownames(metadata_df) <- colnames(count_matrix)"
"0",""
"0","# Verify alignment one more time"
"0","cat(""Count matrix column names:"", paste(colnames(count_matrix), collapse = "", ""), ""\n"")"
"1","Count matrix column names:"
"1"," "
"1","MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
"0","cat(""Metadata row names:"", paste(rownames(metadata_df), collapse = "", ""), ""\n"")"
"1","Metadata row names:"
"1"," "
"1","MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
"0","cat(""Names match:"", identical(colnames(count_matrix), rownames(metadata_df)), ""\n"")"
"1","Names match:"
"1"," "
"1","TRUE"
"1"," "
"1","
"
"0","# Ensure count matrix is numeric"
"0","count_matrix <- matrix(as.numeric(count_matrix), "
"0","                       nrow = nrow(count_matrix),"
"0","                       ncol = ncol(count_matrix),"
"0","                       dimnames = dimnames(count_matrix))"
"0",""
"0","# Create DESeqDataSet with full model including interaction"
"0","dds <- DESeqDataSetFromMatrix("
"0","  countData = count_matrix,"
"0","  colData = metadata_df,"
"0","  design = ~ CellType + Status + CellType:Status"
"0",")"
"0",""
"0","# Pre-filter low count genes"
"0","keep <- rowSums(counts(dds)) >= 10"
"0","dds <- dds[keep, ]"
"0",""
"0","cat(""Number of genes before filtering:"", nrow(count_matrix), ""\n"")"
"1","Number of genes before filtering:"
"1"," "
"1","24094"
"1"," "
"1","
"
"0","cat(""Number of genes after filtering:"", nrow(dds), ""\n"")"
"1","Number of genes after filtering:"
"1"," "
"1","17053"
"1"," "
"1","
"
