"0","# Select 4 interesting genes with different patterns"
"0","# We'll pick genes from different clusters or with high significance"
"0","interesting_genes <- res_status_df %>%"
"0","  filter(padj < 0.05, !is.na(padj)) %>%"
"0","  arrange(padj) %>%"
"0","  head(4)"
"0",""
"0","# Function to plot gene across timepoints"
"0","# Use dds_lrt_status which has been processed through DESeq() and has size factors"
"0","plot_gene_temporal <- function(ensembl_id, gene_symbol) {"
"0","  # Extract normalized counts from the processed DESeqDataSet"
"0","  plot_data <- data.frame("
"0","    Count = counts(dds_lrt_status[ensembl_id, ], normalized = TRUE)[1, ],"
"0","    Status = colData(dds_lrt_status)$Status,"
"0","    CellType = colData(dds_lrt_status)$CellType,"
"0","    Sample = colnames(dds_lrt_status)"
"0","  )"
"0","  "
"0","  # Calculate means and SE for each group"
"0","  plot_summary <- plot_data %>%"
"0","    group_by(CellType, Status) %>%"
"0","    summarize("
"0","      mean_count = mean(Count),"
"0","      se_count = sd(Count) / sqrt(n()),"
"0","      .groups = ""drop"""
"0","    )"
"0","  "
"0","  ggplot(plot_summary, aes(x = Status, y = mean_count, "
"0","                           color = CellType, group = CellType)) +"
"0","    geom_line(size = 1.2) +"
"0","    geom_point(size = 4) +"
"0","    geom_errorbar(aes(ymin = mean_count - se_count, "
"0","                      ymax = mean_count + se_count),"
"0","                  width = 0.1, size = 0.8) +"
"0","    facet_wrap(~ CellType, ncol = 2) +"
"0","    scale_y_log10() +"
"0","    theme_bw() +"
"0","    labs(title = paste0(""Expression Pattern: "", gene_symbol),"
"0","         y = ""Normalized Counts (log10 scale)"","
"0","         x = ""Developmental Stage"") +"
"0","    scale_color_manual(values = c(""basal"" = ""steelblue"", ""luminal"" = ""coral"")) +"
"0","    theme(legend.position = ""none"","
"0","          axis.text.x = element_text(angle = 45, hjust = 1))"
"0","}"
"0",""
"0","# Plot each gene"
"0","for (i in 1:4) {"
"0","  print(plot_gene_temporal(interesting_genes$EnsemblID[i], "
"0","                          interesting_genes$GeneSymbol[i]))"
"0","}"
