"0","# Extract sample columns"
"0","sample_cols <- setdiff(colnames(counts), c(""EnsemblID"", ""GeneSymbol""))"
"0","count_matrix <- as.matrix(counts[, sample_cols])"
"0",""
"0","# Set row names to EnsemblID"
"0","rownames(count_matrix) <- counts$EnsemblID"
"0",""
"0","# Clean sample names if needed"
"0","colnames(count_matrix) <- gsub(""\\.(bam|sam)$"", """", colnames(count_matrix))"
"0",""
"0","# Verify sample names match"
"0","cat(""Sample names in counts:"", paste(colnames(count_matrix), collapse = "", ""), ""\n"")"
"1","Sample names in counts:"
"1"," "
"1","MCL1.LA, MCL1.LB, MCL1.LC, MCL1.LD, MCL1.LE, MCL1.LF, MCL1.DG, MCL1.DH, MCL1.DI, MCL1.DJ, MCL1.DK, MCL1.DL"
"1"," "
"1","
"
"0","cat(""Sample names in metadata:"", paste(metadata$Sample, collapse = "", ""), ""\n"")"
"1","Sample names in metadata:"
"1"," "
"1","GSM1480291, GSM1480292, GSM1480293, GSM1480294, GSM1480295, GSM1480296, GSM1480297, GSM1480298, GSM1480299, GSM1480300, GSM1480301, GSM1480302"
"1"," "
"1","
"
"0","# Check for matching samples"
"0","samples_in_both <- intersect(colnames(count_matrix), metadata$Sample)"
"0","cat(""Samples in both counts and metadata:"", length(samples_in_both), ""\n"")"
"1","Samples in both counts and metadata:"
"1"," "
"1","0"
"1"," "
"1","
"
"0","if (length(samples_in_both) < length(metadata$Sample)) {"
"0","  cat(""Warning: Some metadata samples not found in counts\n"")"
"0","  cat(""Missing from counts:"", setdiff(metadata$Sample, colnames(count_matrix)), ""\n"")"
"0","}"
"1","Warning: Some metadata samples not found in counts
"
"1","Missing from counts:"
"1"," "
"1","GSM1480291"
"1"," "
"1","GSM1480292"
"1"," "
"1","GSM1480293"
"1"," "
"1","GSM1480294"
"1"," "
"1","GSM1480295"
"1"," "
"1","GSM1480296"
"1"," "
"1","GSM1480297"
"1"," "
"1","GSM1480298"
"1"," "
"1","GSM1480299"
"1"," "
"1","GSM1480300"
"1"," "
"1","GSM1480301"
"1"," "
"1","GSM1480302"
"1"," "
"1","
"
"0","if (length(samples_in_both) < length(colnames(count_matrix))) {"
"0","  cat(""Warning: Some count samples not found in metadata\n"")"
"0","  cat(""Missing from metadata:"", setdiff(colnames(count_matrix), metadata$Sample), ""\n"")"
"0","}"
"1","Warning: Some count samples not found in metadata
"
"1","Missing from metadata:"
"1"," "
"1","MCL1.LA"
"1"," "
"1","MCL1.LB"
"1"," "
"1","MCL1.LC"
"1"," "
"1","MCL1.LD"
"1"," "
"1","MCL1.LE"
"1"," "
"1","MCL1.LF"
"1"," "
"1","MCL1.DG"
"1"," "
"1","MCL1.DH"
"1"," "
"1","MCL1.DI"
"1"," "
"1","MCL1.DJ"
"1"," "
"1","MCL1.DK"
"1"," "
"1","MCL1.DL"
"1"," "
"1","
"
