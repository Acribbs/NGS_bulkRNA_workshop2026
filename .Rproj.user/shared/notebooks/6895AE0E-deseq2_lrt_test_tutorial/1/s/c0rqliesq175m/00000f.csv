"0","# Set factors with appropriate reference levels"
"0","metadata$Status <- factor(metadata$Status, levels = c(""virgin"", ""pregnant"", ""lactate""))"
"0","metadata$CellType <- factor(metadata$CellType, levels = c(""basal"", ""luminal""))"
"0","metadata$Group <- factor(metadata$Group)"
"0",""
"0","# Keep only samples that are in both count matrix and metadata"
"0","common_samples <- intersect(colnames(count_matrix), metadata$Sample)"
"0",""
"0","# Filter count matrix to only common samples"
"0","count_matrix <- count_matrix[, common_samples, drop = FALSE]"
"0",""
"0","# Filter and reorder metadata to match count matrix column order"
"0","metadata <- metadata[match(common_samples, metadata$Sample), ]"
"0","rownames(metadata) <- metadata$Sample"
"0",""
"0","# Verify alignment"
"0","cat(""Count matrix dimensions:"", dim(count_matrix), ""\n"")"
"1","Count matrix dimensions:"
"1"," "
"1","24094"
"1"," "
"1","0"
"1"," "
"1","
"
"0","cat(""Metadata dimensions:"", dim(metadata), ""\n"")"
"1","Metadata dimensions:"
"1"," "
"1","0"
"1"," "
"1","5"
"1"," "
"1","
"
"0","cat(""Sample names match:"", identical(colnames(count_matrix), rownames(metadata)), ""\n"")"
"1","Sample names match:"
"1"," "
"1","FALSE"
"1"," "
"1","
"
"0","# Verify"
"0","head(metadata)"
