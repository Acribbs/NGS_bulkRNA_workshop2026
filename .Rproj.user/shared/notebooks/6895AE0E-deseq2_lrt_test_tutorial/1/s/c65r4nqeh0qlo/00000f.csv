"0","# Set factors with appropriate reference levels"
"0","metadata$Status <- factor(metadata$Status, levels = c(""virgin"", ""pregnant"", ""lactate""))"
"0","metadata$CellType <- factor(metadata$CellType, levels = c(""basal"", ""luminal""))"
"0","metadata$Group <- factor(metadata$Group)"
"0",""
"0","# Keep only samples that are in both count matrix and metadata"
"0","# Check if count matrix has column names"
"0","if (is.null(colnames(count_matrix))) {"
"0","  stop(""Count matrix has no column names. Please check the prepare-counts chunk."")"
"0","}"
"0",""
"0","common_samples <- intersect(colnames(count_matrix), metadata$Sample)"
"0",""
"0","cat(""Common samples found:"", length(common_samples), ""\n"")"
"1","Common samples found:"
"1"," "
"1","0"
"1"," "
"1","
"
"0","if (length(common_samples) == 0) {"
"0","  stop(""No common samples found between count matrix and metadata. Please check sample names."")"
"0","}"
"2","Error: No common samples found between count matrix and metadata. Please check sample names.
"
